# Render Blueprint for Outline
# https://render.com/docs/blueprint-spec

services:
  - type: web
    name: outline
    runtime: docker
    dockerfilePath: ./Dockerfile
    region: oregon
    plan: standard
    healthCheckPath: /_health
    envVars:
      # Core Configuration
      - key: NODE_ENV
        value: production
      - key: PORT
        value: "10000"
      - key: SECRET_KEY
        sync: false
      - key: UTILS_SECRET
        sync: false
      - key: URL
        sync: false

      # Database
      - key: DATABASE_URL
        sync: false
      - key: PGSSLMODE
        value: require

      # Redis
      - key: REDIS_URL
        sync: false

      # File Storage
      - key: FILE_STORAGE
        value: s3
      - key: AWS_ACCESS_KEY_ID
        sync: false
      - key: AWS_SECRET_ACCESS_KEY
        sync: false
      - key: AWS_REGION
        sync: false
      - key: AWS_S3_UPLOAD_BUCKET_NAME
        sync: false
      - key: AWS_S3_UPLOAD_BUCKET_URL
        sync: false
      - key: AWS_S3_ACL
        value: private

      # SSL/HTTPS (Render handles SSL termination)
      - key: FORCE_HTTPS
        value: "true"

      # Authentication (configure at least one)
      - key: SLACK_CLIENT_ID
        sync: false
      - key: SLACK_CLIENT_SECRET
        sync: false
      - key: GOOGLE_CLIENT_ID
        sync: false
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      - key: AZURE_CLIENT_ID
        sync: false
      - key: AZURE_CLIENT_SECRET
        sync: false
      - key: OIDC_CLIENT_ID
        sync: false
      - key: OIDC_CLIENT_SECRET
        sync: false
      - key: OIDC_AUTH_URI
        sync: false
      - key: OIDC_TOKEN_URI
        sync: false
      - key: OIDC_USERINFO_URI
        sync: false

      # Email (SMTP)
      - key: SMTP_HOST
        sync: false
      - key: SMTP_PORT
        sync: false
      - key: SMTP_USERNAME
        sync: false
      - key: SMTP_PASSWORD
        sync: false
      - key: SMTP_FROM_EMAIL
        sync: false

      # Optional Integrations
      - key: SENTRY_DSN
        sync: false

      # Rate Limiter
      - key: RATE_LIMITER_ENABLED
        value: "true"

      # Logging
      - key: LOG_LEVEL
        value: info
      - key: DEBUG
        value: http

# Preview Environments Configuration
# Automatically creates preview deployments for pull requests
previews:
  generation: automatic
